<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title></title>
    <!--<link href="../../Plugins/bootstrap/bootstrap.min.css" rel="stylesheet" />-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">

    <link href="../../Plugins/Bootstrap-table/bootstrap-dialog.min.css" rel="stylesheet" />
    <link href="../../Plugins/Bootstrap-table/bootstrap-table.css" rel="stylesheet" />
    <link href="../../Plugins/select2/select2.min.css" rel="stylesheet" />
    <style>
        .row{
            margin:10px;
        }
    </style>
</head>
<body>
   <div class="container" style="margin-top:20px">
       <div class="row">
           <div class="col-md-4">
               <input type="number" id="txtnum" class="form-control" placeholder="Please Enter number of columns" />
           </div>
           <div class="col-md-4">
               <input type="text" id="txtproc" class="form-control" placeholder="Please Enter Webmethod" />
           </div>
           <div class="col-md-2">
               <button class="btn btn-primary" id="btnadd">Add</button>
           </div>
       </div>
       <div class="row">
           <label>Dynamic Textboxes</label>
           <div class="row" id="dynamicdivheader">

           </div>
           <div class="row" id="dynamicdivfield">

           </div>
           <div class="row">
               <button id="btnsubmit" class="btn btn-success">Submit</button>
           </div>
       </div>
   </div>
    <div class="row" id="divtbl">
        <div class="col-xl-12">
            <table id="tbl"></table>
        </div>
    </div>
    <script src="../../Plugins/jQuery/jQuery.min.js"></script>
    <script src="../../Plugins/jQuery/jQuery.min.js"></script>
    <script src="../../Plugins/select2/select2.min.js"></script>
    <script src="../../Plugins/bootstrap/bootstrap.min.js"></script>
    <script src="../../Plugins/Bootstrap-table/bootstrap-dialog.min.js"></script>
    <script src="../../Plugins/Bootstrap-table/tableExport.js"></script>
    <script src="../../Plugins/Bootstrap-table/jspdf.min.js"></script>
    <script src="../../Plugins/Bootstrap-table/jspdf.plugin.autotable.js"></script>

    <script src="../../Plugins/Bootstrap-table/bootstrap-table.js"></script>
    <script src="../../Plugins/Bootstrap-table/bootstrap-table.js"></script>
    <script src="../../Plugins/Bootstrap-table/bootstrap-table-export.js"></script>
    <script type="text/javascript">
        $("#btnsubmit").click(function () {
            var val = $("#txtnum").val();
            for (var i = 1; i <= val; i++) {
               // var id = "th" + i;
                if ($("#th" + i).val() == "") {
                    $("#th" + i).focus();
                    alert("Please Enter value");
                    return false;
                }
                else {
                   // alert("ok");
                }
            }
        })
        $("#btnadd").click(function () {
            var val = $("#txtnum").val();
            var res = "";
            var res1 = "";
            for (var i = 1; i <= val; i++){
                res += txtheader(i);
                res1 += txtfield(i);
            }
            $("#dynamicdivheader").append(res);
            $("#dynamicdivfield").append(res1);
        })
        var txtheader = (v) => {
            return '<div class="col-md-3"><input type="text" id="th' + v + '" class="form-control" placeholder="Please Enter header ' + v + '"/></div>';
        }
        var txtfield = (v) => {
            return '<div class="col-md-3"><input type="text" id="tf' + v + '" class="form-control" placeholder="Please Enter Value Field ' + v + '"/></div>';
        }
        var tablecolumns_array = [];
        var bindtasble = $('#tbl');
        $remove = $('#remove');
        selections = [];
       

        $(function () {
            $(".select2").select2();
            //  alert($("td:eq(0)").html());
           
           // GetVendorWisePriceDetails();
            
            //GetVendorWisePriceDetails();
            // GetWeekMaster();
            console.log(tablecolumns_array);
        })


        $("#txtval").change(function () {
           
                tablecolumns_array = [
                    [
                        //WeekId	WeekName	COA	COA_DueInDays	DSA	DSA_DueInDays	NSA	NSA_DueInDays	OS	OS_DueInDays	PCS	PCS_DueInDays

                        //{ title: 'Week', field: 'WeekId', align: 'center', valign: 'middle', sortable: true },
                        { title: '', field: 'WeekName', align: 'left', valign: 'middle', sortable: true, visible: true },
                        { title: '', field: 'COA', align: 'left', valign: 'middle', sortable: true, },
                        { title: '', field: 'COA_DueInDays', align: 'left', valign: 'middle', sortable: true, },
                        { title: '', field: 'DSA', align: 'left', valign: 'middle', sortable: true, },
                        { title: '', field: 'DSA_DueInDays', align: 'left', valign: 'middle', sortable: true, visible: true },
                        { title: '', field: 'NSA', align: 'left', valign: 'middle', sortable: true, visible: true },
                        { title: '', field: 'NSA_DueInDays', align: 'left', valign: 'middle', visible: true, },
                        { title: '', field: 'OS', align: 'left', valign: 'middle', sortable: true, visible: true },
                        { title: '', field: 'OS_DueInDays', align: 'left', valign: 'middle', sortable: true, visible: true },
                        { title: '', field: 'PCS', align: 'left', valign: 'middle', sortable: true, visible: true },
                        { title: '', field: 'PCS_DueInDays', align: 'left', valign: 'middle', sortable: true, visible: true },
                    ]

                ];
                tablecolumns_array[0][0]["title"] = $("#txtval").val();

                initTable(bindtasble, "Assignment Due Dates", "Assignment Due Dates", tablecolumns_array);

                // GetVendorWisePriceDetails_FromDB();

        })
     

        function GetVendorWisePriceDetails_FromDB() {//fun start
            var CR_report = [];
            //debugger;
            var Result = Ajaxfunctioncall_WithOutParams("GetAssignmentReportData", "Assignment");


            if (Result != '') {

                if (Result.length > 0) {
                    var result_dt = JSON.parse(Result);
                    CR_report = result_dt;
                    bindtasble.bootstrapTable('load', CR_report);


                }
                else {
                    bindtasble.bootstrapTable('load', CR_report);
                }

            }
            else {
                bindtasble.bootstrapTable('load', CR_report);
            }




        }
        //----------------------------------------------------------------------------------


        function initTable(bindtable, file_name, worksheet_name, column_array) {

            bindtable.bootstrapTable({

                exportOptions: {
                    escape: false,
                    fileName: file_name
                    , worksheetName: worksheet_name
                },
                // exportDataType:$(this).val(),
                // exportTypes:['excel','pdf'],
                toolbar: "#toolbar",
                search: true,
                showRefresh: true,
                showToggle: true,
                showColumns: true,
                showExport: true,
                //        detailView: true,
                //        detailFormatter: "detailFormatter",
                minimumCountColumns: 2,
                showPaginationSwitch: true,
                pagination: true,
                idField: "id",
                pageSize: 6,
                pageList: "[5,10, 25, 50, 100, ALL]",
                showFooter: false,
                height: getHeight(),
                columns: column_array

            });



            // sometimes footer render error.
            setTimeout(function () {
                bindtable.bootstrapTable('resetView');
            }, 200);
            bindtable.on('check.bs.table uncheck.bs.table ' +
                'check-all.bs.table uncheck-all.bs.table', function () {
                    $remove.prop('disabled', !bindtable.bootstrapTable('getSelections').length);

                    //debugger;
                    // save your data, here just save the current page
                    selections = getIdSelections();
                    // push or splice the selections if you want to save all data selections
                });
            bindtable.on('expand-row.bs.table', function (e, index, row, $detail) {
                //if (index % 2 == 1) {
                //    $detail.html('Loading from ajax request...');
                //    $.get('LICENSE', function (res) {
                //        $detail.html(res.replace(/\n/g, '<br>'));
                //    });
                //}
            });
            bindtable.on('all.bs.table', function (e, name, args) {
                console.log(name, args);
            });
            $remove.click(function () {
                //   debugger;
                BootstrapDialog.confirm('Are you sure you want to Delete this selected rows?', function (result) {
                    if (result) {

                        var ids = getIdSelections();
                        for (var i = 0; i < ids.length; i++) {
                            var Deletestatus = DeleteEmployees(JSON.stringify(ids[i]));
                            if (Number(Deletestatus) > 0) {
                                //alert('success');
                                bindtable.bootstrapTable('remove', {
                                    field: 'SNO',
                                    values: ids
                                });
                            }
                            bindtable.bootstrapTable('load', EmployeeData());
                            bindtable.prop('disabled', true);
                        }

                    }
                });



            });
            $(window).resize(function () {
                bindtable.bootstrapTable('resetView', {
                    height: getHeight()
                });
            });





        }

        function getHeight() {
            //return $(window).height() - $('h1').outerHeight(true);
            return 610;
            //for default table height
        }

        function getIdSelections() {
            return $.map($table.bootstrapTable('getSelections'), function (row) {
                return row.SNO
            });
        }



        function detailFormatter(index, row) {
            //alert('You Expand, row: ' + JSON.stringify(row));
            var resultobj = {};

            resultobj.ItemType_Id = row.ItemType_Id;
            var tblcontent = BindItemModal(resultobj);

            return tblcontent;
        }


        //for table binding functions end
        /////////////////////////////////////////////////////////////////////////////////////////////////////**************************************\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\








        function Ajaxfunctioncall_WithOutParams(pagename, methodname) {
            var retresponse = '';
            var urlmethod = "/" + methodname; //  '/SaveValues';
            //ajax fun start
            $.ajax({
                type: "POST",
                url: pagename + urlmethod, // '/SaveEvent',
                // data: JSON.stringify({ inputparamJSON: inputobj }),
                data: {},
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                async: false,
                beforeSend: function () {
                    //  Checklogoutsession();
                },
                success: function (data) {
                    //    debugger;
                    var msg = data.d;
                    // alert('Your Request Successfully');
                    retresponse = data;
                },
                error: function (xhr, errorType, exception) {
                    var responseText;
                    try {
                        responseText = jQuery.parseJSON(xhr.responseText);
                        alert('error message' + responseText.Message);
                    } catch (e) {
                        responseText = xhr.responseText;
                        alert(responseText);
                    }
                }
            });

            //ajax fun end


            return retresponse;
        }


    </script>
</body>
</html>