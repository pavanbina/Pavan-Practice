
@{
    ViewBag.Title = "JsPdf";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link href="~/Content/Quartzbootstrap.min.css" rel="stylesheet" />
<style type="text/css">
    .html-content{
        background:skyblue;
        margin:20px;
        padding:40px;
    }
</style>
<div class="container html-content" style="width:700px;">
    <pre> 	Andhra Pradesh State Housing Corporation Ltd
__________  District

Material Payment Release Order : Flush Door  Shutters	


MPRO No : Dist.code Mandal code godown ID MPRO code               Dt: ___________

Sub:	APSHCL – Procurement of of  Flush Door  Shutters from M/s. ________________ (Company) – Release of Payment for the supplies made – Orders – Issued – Reg.  

Ref:	(1)	Purchase Order No._____________, dt._________ of MD, APHCL, Vijayawada.
(2)	Confirmation made by AE/DEE/EE concerned
****
In accordance to the request made by the PD(H) _________________ purchase order was placed with M/s. __________________ (Company) vide reference 1st cited by MD, APSHCL for supply of  Flush Door  Shutters  of  Double leaf of size 805 mm x 1855 mm  _______ Nos &#64;  Rs.3546/- per 1 No. and Flush Door shutters of Single leaf of size 805 mm x 1855 mm _______ Nos &#64;  Rs,3374/- per 1 No. to various destinations in ______________ district.
Accordingly, M/s. _________ (Company) has supplied _______ Nos. of Flush Door  Shutters  of  Double leaf of size 805 mm x 1855 mm and ________ Nos and Flush Door shutters of Single leaf of size 805 mm x 1855 mm to the various destinations in ________________ District. The concerned EA/WAS/Assistant Engineer & Dy. Executive Engineer have confirmed the receipt of above said quantity in good condition and entered in stock registers. The Executive Engineer ______ has recommended payment of Rs.________/- towards 98% of value of Flush Door  Shutters received.  The invoice wise details are appended.
Therefore, Sanction is here by accorded for release of Rs______ (Rupees _______________only) to M/s. ______________ (company) towards cost of _______Nos  ( Double Leaf Flush Door Shutters ____  Nos. & Single Leaf Flush Door shutter __  Nos.) of Flush Door  Shutters received (98% of value) .  Invoice wise details are appended. 
The  Finance wing, APSHCL, Head office is requested to take necessary action to  release the above said payment to M/s. ____________ (company)
                                                                                                  Digital Signature of PD ___________District
Copy to  M/s. _______ ______ (company)  for information.
Copy to the Executive Engineer (Materials),  APSHCL, Head Office for information.
Copy to the Manager,  O/o. __________ District  office for necessary action. 
</pre>
   
</div>
@section scripts{
    <script src="~/Content/Scripts/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
    <script type="text/javascript" src="https://html2canvas.hertzen.com/dist/html2canvas.js"></script>
    <script type="text/javascript">
        $(function () {
            CreatePDFfromHTML();
           
            function CreatePDFfromHTML(filename) {
                var HTML_Width = $(".html-content").width();
                var HTML_Height = $(".html-content").height();
                var top_left_margin = 0;
                var PDF_Width = HTML_Width + (top_left_margin * 2);
                var PDF_Height = (PDF_Width * 1.5) + (top_left_margin * 2);
                var canvas_image_width = HTML_Width;
                var canvas_image_height = HTML_Height;

                var totalPDFPages = Math.ceil(HTML_Height / PDF_Height) - 1;

                html2canvas($(".html-content")[0], { useCORS: true }).then(function (canvas) {
                    var imgData = canvas.toDataURL("image/jpeg", 1.0);
                      var pdf = new jsPDF('p', 'pt', [PDF_Width, PDF_Height]);
                    /* var pdf = new jsPDF('l', 'in', 'a4');*/
                    pdf.internal.scaleFactor = 30;
                    pdf.addImage(imgData, 'JPEG', top_left_margin, top_left_margin, canvas_image_width, canvas_image_height);
                    for (var i = 1; i <= totalPDFPages; i++) {
                        pdf.addPage(PDF_Width, PDF_Height);
                        pdf.addImage(imgData, 'JPEG', top_left_margin, -(PDF_Height * i) + (top_left_margin * 4), canvas_image_width, canvas_image_height);
                    }
                    pdf.save(filename);
                    //var pdf = new jsPDF('l', 'in', 'a4');
                    //pdf.internal.scaleFactor = 30;
                    //pdf.addHTML($('#print-area')[0], function () {
                    //    pdf.save(calendarName);
                    //});
                });

            }
        });
         //Create PDf from HTML...
            //function CreatePDFfromHTML() {
            //    var HTML_Width = $(".html-content").width();
            //    var HTML_Height = $(".html-content").height();
            //    var top_left_margin = 15;
            //    var PDF_Width = HTML_Width + (top_left_margin * 2);
            //    var PDF_Height = (PDF_Width * 1.5) + (top_left_margin * 2);
            //    var canvas_image_width = HTML_Width;
            //    var canvas_image_height = HTML_Height;

            //    var totalPDFPages = Math.ceil(HTML_Height / PDF_Height) - 1;

            //    html2canvas($(".html-content")[0]).then(function (canvas) {
            //        var imgData = canvas.toDataURL("image/jpeg", 1.0);
            //        var pdf = new jsPDF('p', 'pt', [PDF_Width, PDF_Height]);
            //        pdf.addImage(imgData, 'JPG', top_left_margin, top_left_margin, canvas_image_width, canvas_image_height);
            //        for (var i = 1; i <= totalPDFPages; i++) {
            //            pdf.addPage(PDF_Width, PDF_Height);
            //            pdf.addImage(imgData, 'JPG', top_left_margin, -(PDF_Height * i) + (top_left_margin * 4), canvas_image_width, canvas_image_height);
            //        }
            //        pdf.save("Your_PDF_Name.pdf");
            //        //$(".html-content").hide();
            //    });
            //}
    </script>
}