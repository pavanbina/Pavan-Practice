import { Component } from '@angular/core';
import * as PptxGenJS from 'pptxgenjs';

@Component({
  selector: 'app-range-bar-chart',
  templateUrl: './range-bar-chart.component.html',
  styleUrls: ['./range-bar-chart.component.css']
})
export class RangeBarChartComponent {

  generatePpt(): void {
    // Create a new PowerPoint presentation
    const pptx = new PptxGenJS();

    // Define the data for the range bar chart
    const chartData = [
      { category: "Category 1", value: 20 },
      { category: "Category 2", value: 40 },
      { category: "Category 3", value: 60 },
      { category: "Category 4", value: 80 },
      { category: "Category 5", value: 100 }
    ];

    // Create a slide for the range bar chart
    const slide = pptx.addSlide();

    // Set the title for the slide
    slide.addText("One-Dimensional Range Bar Chart", { x: 1, y: 0.5, w: "80%", h: 1, align: "center", fontSize: 20 });

    // Calculate the total height of the range bars
    const totalHeight = 8;

    // Calculate the height of each range bar
    const barHeight = totalHeight / chartData.length;

    // Add the range bars to the slide
    chartData.forEach((data, index) => {
      const startY = 2 + index * barHeight;
      const endY = startY + barHeight;
      const shapeOptions = {
        x: 1,
        y: startY,
        w: data.value,
        h: endY - startY,
        fill: { type: 'solid', color: '0088CC' },
      };
      slide.addShape(PptxGenJS.shapes.RECTANGLE, shapeOptions);
      slide.addText(data.category, { x: 0, y: startY, w: 0.8, h: endY - startY, align: "right", fontSize: 14, valign: "middle" });
    });

    // Save the PowerPoint presentation
    pptx.writeFile("range_bar_chart.pptx");
  }

}
